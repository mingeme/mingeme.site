---
import { getCollection } from 'astro:content';
import PostCard from '../components/PostCard.astro';
import BaseLayout from '../layouts/BaseLayout.astro';

const title = `Mingeme's miscellaneous talks`;

const allPosts = (await getCollection('posts'))
  .filter((post) => post.data.public && post.data.misc)
  .sort((a, b) => {
    const d1 = new Date(a.data.pubDate);
    const d2 = new Date(b.data.pubDate);
    return d2.getTime() - d1.getTime();
  });
---

<BaseLayout title={title}>
  <div class="mx-auto w-full max-w-4xl space-y-10 px-4 py-12 sm:px-6 lg:px-8 lg:py-16">
    <section class="text-center">
      <h1 class="text-3xl font-bold text-primary sm:text-4xl">杂记</h1>
      <p class="mt-4 text-base text-text-light/70">
        这里收录日常里不成体系的思考、速记和灵感草稿，节奏更随意，也更个人。
      </p>
    </section>

    {
      allPosts.length === 0 ? (
        <p class="text-center text-sm text-text-light/60">暂时还没有内容，等我写点什么。</p>
      ) : (
        <div class="space-y-4">
          {allPosts.map((post) => (
            <PostCard url={post.slug} frontmatter={post.data} />
          ))}
        </div>
      )
    }
  </div>
</BaseLayout>
